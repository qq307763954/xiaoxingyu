<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>通话记录 - 小星语</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <style>
        .ios-status-bar {
            height: 20px;
            background-color: #f8fafc;
            color: black;
        }
        .record-card {
            background-color: white;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .record-card:active {
            background-color: #f9fafb;
        }
        .expert-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }
        .badge {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 20px;
            background-color: #EFF6FF;
            color: #3B82F6;
            margin-right: 8px;
        }
        .badge.completed {
            background-color: #F0FDF4;
            color: #10B981;
        }
        .badge.canceled {
            background-color: #FEF2F2;
            color: #EF4444;
        }
        .badge.scheduled {
            background-color: #FFF7ED;
            color: #F97316;
        }
        .divider {
            height: 1px;
            background-color: #E5E7EB;
            margin: 16px 0;
        }
        .tab {
            padding: 12px 16px;
            text-align: center;
            color: #6B7280;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
            font-weight: 500;
        }
        .tab.active {
            color: #3B82F6;
            border-bottom-color: #3B82F6;
        }
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 0;
            color: #9CA3AF;
            text-align: center;
        }
        .empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
            color: #E5E7EB;
        }
        .return-link {
            display: flex;
            align-items: center;
            color: #6B7280;
            font-size: 14px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col h-screen">
    <!-- iOS状态栏 -->
    <div class="ios-status-bar flex justify-between items-center px-4">
        <div class="time">10:30</div>
        <div class="status-icons flex space-x-2">
            <i class="fas fa-signal"></i>
            <i class="fas fa-wifi"></i>
            <i class="fas fa-battery-full"></i>
        </div>
    </div>
    
    <!-- 内容区域 -->
    <div class="flex-1 overflow-auto">
        <div class="px-4 py-4">
            <a href="../tabs/expert.html" class="return-link">
                <i class="fas fa-chevron-left mr-2"></i> 返回专家页面
            </a>
            
            <h1 class="text-2xl font-bold mb-4">通话记录</h1>
            
            <!-- 标签栏 -->
            <div class="flex border-b border-gray-200 mb-4">
                <div class="tab active" data-tab="all">全部</div>
                <div class="tab" data-tab="completed">已完成</div>
                <div class="tab" data-tab="scheduled">待进行</div>
                <div class="tab" data-tab="canceled">已取消</div>
            </div>
            
            <!-- 搜索框 -->
            <div class="mb-4 relative">
                <input type="text" placeholder="搜索医生姓名或日期..." 
                       class="w-full p-3 pl-10 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            </div>
            
            <!-- 记录列表 -->
            <div id="recordList">
                <!-- 已完成的通话记录 -->
                <div class="record-card" data-status="completed">
                    <div class="flex">
                        <img src="https://cdn-icons-png.flaticon.com/512/3774/3774299.png" alt="张医生" class="expert-avatar">
                        <div class="ml-3 flex-1">
                            <div class="flex justify-between">
                                <h3 class="font-medium">张医生</h3>
                                <span class="text-sm text-gray-500">10月15日</span>
                            </div>
                            <p class="text-sm text-gray-500 mt-1">心理咨询师 | 情绪管理专家</p>
                            <div class="flex items-center mt-2">
                                <span class="badge completed">已完成</span>
                                <span class="text-sm text-gray-500">视频通话 · 45分钟</span>
                            </div>
                        </div>
                    </div>
                    <div class="divider"></div>
                    <div class="flex justify-between items-center">
                        <div class="text-sm text-gray-500">
                            <i class="far fa-clock mr-1"></i> 15:30 - 16:15
                        </div>
                        <a href="call_summary.html" class="text-blue-500 flex items-center text-sm">
                            查看总结 <i class="fas fa-chevron-right ml-1 text-xs"></i>
                        </a>
                    </div>
                </div>
                
                <div class="record-card" data-status="completed">
                    <div class="flex">
                        <img src="https://cdn-icons-png.flaticon.com/512/3135/3135789.png" alt="李医生" class="expert-avatar">
                        <div class="ml-3 flex-1">
                            <div class="flex justify-between">
                                <h3 class="font-medium">李医生</h3>
                                <span class="text-sm text-gray-500">10月10日</span>
                            </div>
                            <p class="text-sm text-gray-500 mt-1">心理咨询师 | 睡眠障碍专家</p>
                            <div class="flex items-center mt-2">
                                <span class="badge completed">已完成</span>
                                <span class="text-sm text-gray-500">语音通话 · 30分钟</span>
                            </div>
                        </div>
                    </div>
                    <div class="divider"></div>
                    <div class="flex justify-between items-center">
                        <div class="text-sm text-gray-500">
                            <i class="far fa-clock mr-1"></i> 10:00 - 10:30
                        </div>
                        <a href="call_summary.html" class="text-blue-500 flex items-center text-sm">
                            查看总结 <i class="fas fa-chevron-right ml-1 text-xs"></i>
                        </a>
                    </div>
                </div>
                
                <!-- 已预约待进行的通话 -->
                <div class="record-card" data-status="scheduled">
                    <div class="flex">
                        <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="王医生" class="expert-avatar">
                        <div class="ml-3 flex-1">
                            <div class="flex justify-between">
                                <h3 class="font-medium">王医生</h3>
                                <span class="text-sm text-gray-500">10月20日</span>
                            </div>
                            <p class="text-sm text-gray-500 mt-1">心理咨询师 | 儿童心理专家</p>
                            <div class="flex items-center mt-2">
                                <span class="badge scheduled">待进行</span>
                                <span class="text-sm text-gray-500">视频通话 · 45分钟</span>
                            </div>
                        </div>
                    </div>
                    <div class="divider"></div>
                    <div class="flex justify-between items-center">
                        <div class="text-sm text-gray-500">
                            <i class="far fa-clock mr-1"></i> 14:00 - 14:45
                        </div>
                        <div class="flex space-x-3">
                            <button class="text-red-500 text-sm">取消</button>
                            <button class="text-blue-500 text-sm">修改</button>
                        </div>
                    </div>
                </div>
                
                <!-- 已取消的通话 -->
                <div class="record-card" data-status="canceled">
                    <div class="flex">
                        <img src="https://cdn-icons-png.flaticon.com/512/3135/3135755.png" alt="赵医生" class="expert-avatar">
                        <div class="ml-3 flex-1">
                            <div class="flex justify-between">
                                <h3 class="font-medium">赵医生</h3>
                                <span class="text-sm text-gray-500">10月5日</span>
                            </div>
                            <p class="text-sm text-gray-500 mt-1">心理咨询师 | 婚恋关系专家</p>
                            <div class="flex items-center mt-2">
                                <span class="badge canceled">已取消</span>
                                <span class="text-sm text-gray-500">视频通话 · 45分钟</span>
                            </div>
                        </div>
                    </div>
                    <div class="divider"></div>
                    <div class="flex justify-between items-center">
                        <div class="text-sm text-gray-500">
                            <i class="far fa-clock mr-1"></i> 16:00 - 16:45
                        </div>
                        <a href="appointment.html" class="text-blue-500 flex items-center text-sm">
                            重新预约 <i class="fas fa-chevron-right ml-1 text-xs"></i>
                        </a>
                    </div>
                </div>
                
                <!-- 隐藏的空状态，当没有符合条件的记录时显示 -->
                <div class="empty-state hidden">
                    <div class="empty-icon">
                        <i class="far fa-calendar-times"></i>
                    </div>
                    <p class="mb-2">暂无通话记录</p>
                    <p class="text-sm">您可以预约专家进行心理咨询</p>
                    <a href="appointment.html" class="mt-4 px-6 py-2 bg-blue-500 text-white rounded-lg">
                        预约咨询
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // 显示当前时间
        function updateTime() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            document.querySelector('.time').textContent = `${hours}:${minutes}`;
        }
        
        // 标签切换逻辑
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            const records = document.querySelectorAll('.record-card');
            const emptyState = document.querySelector('.empty-state');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // 切换标签样式
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    const tabType = this.getAttribute('data-tab');
                    
                    // 过滤记录
                    let visibleCount = 0;
                    records.forEach(record => {
                        const status = record.getAttribute('data-status');
                        if (tabType === 'all' || status === tabType) {
                            record.classList.remove('hidden');
                            visibleCount++;
                        } else {
                            record.classList.add('hidden');
                        }
                    });
                    
                    // 显示或隐藏空状态
                    if (visibleCount === 0) {
                        emptyState.classList.remove('hidden');
                    } else {
                        emptyState.classList.add('hidden');
                    }
                });
            });
        }
        
        // 搜索功能
        function setupSearch() {
            const searchInput = document.querySelector('input[type="text"]');
            const records = document.querySelectorAll('.record-card');
            const emptyState = document.querySelector('.empty-state');
            
            searchInput.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                let visibleCount = 0;
                
                records.forEach(record => {
                    const doctorName = record.querySelector('h3').textContent.toLowerCase();
                    const date = record.querySelector('.text-sm.text-gray-500').textContent.toLowerCase();
                    
                    if (!record.classList.contains('hidden') && 
                        (doctorName.includes(query) || date.includes(query))) {
                        record.style.display = '';
                        visibleCount++;
                    } else {
                        record.style.display = 'none';
                    }
                });
                
                // 显示或隐藏空状态
                if (visibleCount === 0) {
                    emptyState.classList.remove('hidden');
                } else {
                    emptyState.classList.add('hidden');
                }
            });
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // 更新状态栏时间
            updateTime();
            setInterval(updateTime, 60000); // 每分钟更新一次
            
            // 设置标签和搜索功能
            setupTabs();
            setupSearch();
            
            // 添加记录点击跳转
            const completedRecords = document.querySelectorAll('.record-card[data-status="completed"]');
            completedRecords.forEach(record => {
                record.addEventListener('click', function(e) {
                    // 如果点击的不是具体的操作按钮，则整体跳转
                    if (!e.target.closest('a') && !e.target.closest('button')) {
                        window.location.href = 'call_summary.html';
                    }
                });
            });
            
            // 在实际应用中，这里应该添加取消和修改预约的逻辑
            const cancelButtons = document.querySelectorAll('button.text-red-500');
            cancelButtons.forEach(button => {
                button.addEventListener('click', function() {
                    if (confirm('确定要取消此次预约吗？')) {
                        alert('预约已取消');
                        // 在实际应用中，这里应该发送请求到服务器取消预约，然后刷新页面
                    }
                });
            });
        });
    </script>
</body>
</html>